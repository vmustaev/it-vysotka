# API для работы с командами

## Структура данных

### User (обновлено)
```javascript
{
  id: number,
  email: string,
  first_name: string,
  last_name: string,
  second_name: string,
  teamId: number | null,  // ID команды
  isLead: boolean,        // Является ли лидером команды
  ...
}
```

### Team
```javascript
{
  id: number,
  name: string,
  inviteToken: string,
  captainId: number
}
```

## Endpoints

### 1. Создание команды
**POST** `/api/team/create`

**Требуется авторизация**: Да

**Body**:
```json
{
  "name": "Название команды"
}
```

**Правила названия**:
- От 3 до 50 символов
- Только кириллица, латиница и цифры
- Уникальное название

**Ответ**:
```json
{
  "id": 1,
  "name": "Название команды",
  "inviteToken": "uuid-токен",
  "inviteLink": "http://localhost:3000/team/join/uuid-токен",
  "captain": { "id": 1, "email": "user@mail.com", ... },
  "members": [
    {
      "id": 1,
      "email": "user@mail.com",
      "first_name": "Иван",
      "last_name": "Иванов",
      "second_name": "Иванович",
      "isLead": true
    }
  ],
  "memberCount": 1,
  "createdAt": "2024-01-01T00:00:00.000Z"
}
```

**Результат**: Пользователь получает `teamId` и `isLead = true`

### 2. Присоединение к команде
**POST** `/api/team/join/:inviteToken`

**Требуется авторизация**: Да

**Параметры URL**: `inviteToken` - токен приглашения из ссылки

**Ответ**: Информация о команде

**Ограничения**:
- Пользователь не должен состоять в другой команде (`teamId = null`)
- В команде должно быть меньше 3 человек

**Результат**: Пользователь получает `teamId` команды и `isLead = false`

### 3. Получение информации о своей команде
**GET** `/api/team/my`

**Требуется авторизация**: Да

**Ответ**: 
- Если состоит в команде: информация о команде
- Если не состоит: `{ "team": null, "message": "..." }`

### 4. Выход из команды
**POST** `/api/team/leave`

**Требуется авторизация**: Да

**Ответ**:
```json
{
  "success": true,
  "message": "Вы успешно покинули команду"
}
```

**Ограничения**: Лидер не может выйти (должен удалить команду)

**Результат**: У пользователя `teamId = null` и `isLead = false`

### 5. Исключение участника (только лидер)
**DELETE** `/api/team/kick/:userId`

**Требуется авторизация**: Да (пользователь должен быть лидером, `isLead = true`)

**Параметры URL**: `userId` - ID пользователя для исключения

**Ответ**:
```json
{
  "success": true,
  "message": "Участник исключен из команды"
}
```

**Ограничения**: 
- Только лидер (`isLead = true`) может исключать
- Нельзя исключить себя
- Пользователь должен быть в той же команде

**Результат**: У исключенного пользователя `teamId = null` и `isLead = false`

### 6. Удаление команды (только лидер)
**DELETE** `/api/team/delete`

**Требуется авторизация**: Да (пользователь должен быть лидером, `isLead = true`)

**Ответ**:
```json
{
  "success": true,
  "message": "Команда успешно удалена"
}
```

**Результат**: 
- Команда удаляется
- У всех участников команды `teamId = null` и `isLead = false`

## Роли

### Лидер (создатель команды)
- `isLead = true`
- Создал команду
- Может исключать участников (кроме себя)
- Может удалить команду
- Не может выйти из команды (только удалить)
- Видит ссылку-приглашение

### Участник
- `isLead = false`
- Присоединился по ссылке
- Может только выйти из команды
- Не видит ссылку-приглашение

## Ограничения

- Максимум 3 человека в команде
- Один пользователь может состоять только в одной команде (`teamId` уникален)
- Название команды должно быть уникальным

## Frontend

Вся функциональность команд интегрирована в **Профиль** (`/profile`):
- Просмотр личной информации
- Создание команды
- Просмотр информации о команде
- Управление командой (для лидера)
- Выход/исключение из команды

**Присоединение к команде**: `/team/join/:inviteToken`
