# Комплексная выпускная квалификационная работа
## Веб-приложение для проведения чемпионата по программированию IT-ВыСотка

**Авторы:** Мустаев Венер Фанисович, Якшибаев Данир Ильдарович  
**Кафедра:** ВТИК УГНТУ

---

## Общее описание проекта

Веб-приложение для проведения чемпионата по программированию IT-ВыСотка — комплексная платформа, обеспечивающая полный цикл организации мероприятия: от регистрации участников до генерации сертификатов и публикации результатов.

### Технологический стек

**Backend:** Node.js 20+, Express 5.1, PostgreSQL 15, Sequelize ORM, JWT, Nodemailer, PDF-lib, Multer, ExcelJS

**Frontend:** React 19.2, MobX, React Router 7, Axios

**Инфраструктура:** Docker, Docker Compose, Nginx

---

## Якшибаев Данир Ильдарович
### Пользовательская часть (публичная часть и функционал участников)

### Backend

#### 1. Аутентификация и авторизация
**Файлы:**
- `backend/controllers/user-controller.js` — контроллер пользователей
- `backend/service/user-service.js` — сервис пользователей
- `backend/service/token-service.js` — сервис токенов
- `backend/controllers/password-reset-controller.js` — контроллер сброса пароля
- `backend/middlewares/auth-middleware.js` — middleware аутентификации
- `backend/validation/auth-validation.js` — валидация регистрации/входа
- `backend/validation/password-reset-validation.js` — валидация сброса пароля
- `backend/validation/error-messages.js` — сообщения об ошибках
- `backend/models/user-model.js` — модель пользователя
- `backend/models/token-model.js` — модель токенов
- `backend/dtos/user-dto.js` — DTO пользователя

**API эндпоинты:**
- `POST /api/registration` — регистрация
- `POST /api/login` — вход
- `POST /api/logout` — выход
- `GET /api/activate/:link` — активация аккаунта
- `POST /api/refresh` — обновление токена
- `POST /api/password/reset/request` — запрос сброса пароля
- `POST /api/password/reset` — сброс пароля

**Функционал:**
- Регистрация с валидацией данных
- Хеширование паролей (bcrypt)
- JWT токены (access, refresh)
- Email активация аккаунта
- Восстановление пароля
- Проверка уникальности email и телефона

#### 2. Личный кабинет участника
**Файлы:**
- `backend/controllers/user-controller.js` (методы: getProfile, updateParticipationFormat, updateEssayUrl)

**API эндпоинты:**
- `GET /api/user/profile` — получение профиля
- `PUT /api/user/participation-format` — изменение формата участия
- `PUT /api/user/essay-url` — обновление ссылки на эссе

**Функционал:**
- Просмотр личных данных
- Изменение формата участия
- Добавление ссылки на эссе

#### 3. Система команд
**Файлы:**
- `backend/controllers/team-controller.js` — контроллер команд
- `backend/service/team-service.js` — сервис команд
- `backend/models/team-model.js` — модель команды
- `backend/validation/team-validation.js` — валидация команд

**API эндпоинты:**
- `POST /api/team/create` — создание команды
- `GET /api/team/join/:inviteToken` — присоединение по ссылке
- `POST /api/team/join/:inviteToken` — присоединение (API)
- `GET /api/team/my` — информация о команде
- `POST /api/team/leave` — выход из команды
- `DELETE /api/team/kick/:userId` — исключение участника
- `DELETE /api/team/delete` — удаление команды

**Функционал:**
- Создание команд (до 3 участников)
- Генерация пригласительных ссылок
- Управление составом команды
- Добавление эссе (для лидера)

#### 4. Работа со школами
**Файлы:**
- `backend/controllers/school-controller.js` — контроллер школ
- `backend/service/school-service.js` — сервис школ
- `backend/models/school-model.js` — модель школы
- `backend/scripts/import-schools.js` — импорт школ из CSV
- `backend/educational_orgs_russia.csv` — данные школ России

**API эндпоинты:**
- `GET /api/schools/regions` — список регионов
- `GET /api/schools/cities` — список городов
- `GET /api/schools` — список школ

**Функционал:**
- Каскадный выбор: регион → город → школа
- Импорт данных из CSV
- Фильтрация и поиск

#### 5. Email-уведомления
**Файлы:**
- `backend/service/mail-service.js` — сервис почты

**Функционал:**
- Письма активации аккаунта
- Письма сброса пароля
- Уведомления о выдаче сертификата
- Уведомления о победе
- HTML-шаблоны писем

#### 6. Скачивание сертификатов
**API эндпоинты:**
- `GET /certificates/download/:participantId` — скачивание сертификата

**Функционал:**
- Проверка прав доступа
- Скачивание PDF сертификата

#### 7. Публичные эндпоинты
**API эндпоинты:**
- `GET /api/settings/registration-status` — статус регистрации
- `GET /api/files/type/:type` — файлы по типу
- `GET /api/results/years` — годы с результатами
- `GET /api/results/year/:year` — результаты по году

---

### Frontend

#### 1. Страницы аутентификации
**Файлы:**
- `frontend/app/src/pages/Register.js` — регистрация
- `frontend/app/src/pages/Login.js` — вход
- `frontend/app/src/pages/ResetPasswordRequest.js` — запрос сброса пароля
- `frontend/app/src/pages/ResetPassword.js` — установка нового пароля
- `frontend/app/src/pages/Consent.js` — согласие родителей
- `frontend/app/src/pages/ParticipantConsent.js` — согласие участника

**Функционал:**
- Многоступенчатая форма регистрации
- Валидация в реальном времени
- Проверка статуса регистрации (открыта/закрыта)
- Форматирование телефона
- Выбор формата участия
- Согласие на обработку данных
- Восстановление пароля

#### 2. Личный кабинет
**Файлы:**
- `frontend/app/src/pages/Profile.js` — личный кабинет
- `frontend/app/src/pages/Dashboard.js` — дашборд

**Функционал:**
- Отображение личных данных
- Управление командой
- Добавление ссылки на эссе
- Скачивание сертификата
- Информация о дедлайнах

#### 3. Публичные страницы
**Файлы:**
- `frontend/app/src/pages/Home.js` — главная
- `frontend/app/src/pages/AboutChampionship.js` — о чемпионате
- `frontend/app/src/pages/Regulations.js` — регламенты
- `frontend/app/src/pages/Gallery.js` — галерея
- `frontend/app/src/pages/Results.js` — результаты
- `frontend/app/src/pages/Contacts.js` — контакты
- `frontend/app/src/pages/NotFound.js` — 404

**Функционал:**
- Информация о чемпионате
- Дата и место проведения
- Отображение спонсоров
- Просмотр фотогалереи
- Результаты по годам
- Контактная информация

#### 4. Компоненты
**Файлы:**
- `frontend/app/src/components/Navbar.js` — навигация
- `frontend/app/src/components/Footer.js` — футер
- `frontend/app/src/components/Toast.js` — уведомления
- `frontend/app/src/components/InfoModal.js` — модальные окна
- `frontend/app/src/components/ConfirmDialog.js` — диалоги подтверждения
- `frontend/app/src/components/SearchableSelect.js` — выпадающий список с поиском
- `frontend/app/src/components/SponsorsSection.js` — секция спонсоров
- `frontend/app/src/components/TasksSection.js` — секция задач
- `frontend/app/src/components/PublicGallery.js` — галерея

**Функционал:**
- Адаптивное меню
- Всплывающие уведомления
- Поиск в больших списках
- Отображение контента

#### 5. Управление состоянием и HTTP
**Файлы:**
- `frontend/app/src/store/store.js` — MobX store
- `frontend/app/src/http/index.js` — HTTP клиент (axios)
- `frontend/app/src/App.js` — главный компонент

**Функционал:**
- Управление состоянием аутентификации
- Автоматическое обновление токенов
- Interceptors для запросов
- Роутинг приложения

#### 6. Сервисы
**Файлы:**
- `frontend/app/src/services/AuthService.js` — аутентификация
- `frontend/app/src/services/UserService.js` — пользователи
- `frontend/app/src/services/TeamService.js` — команды
- `frontend/app/src/services/PasswordService.js` — пароли

#### 7. Стили
**Файлы:**
- `frontend/app/src/styles/global.css` — глобальные стили
- `frontend/app/src/styles/variables.css` — CSS переменные
- `frontend/app/src/styles/home.css` — главная страница
- `frontend/app/src/styles/login.css` — вход/регистрация
- `frontend/app/src/styles/register.css` — форма регистрации
- `frontend/app/src/styles/register-closed.css` — закрытая регистрация
- `frontend/app/src/styles/profile.css` — личный кабинет
- `frontend/app/src/styles/reset-password.css` — сброс пароля
- `frontend/app/src/styles/consent.css` — согласия
- `frontend/app/src/styles/regulations.css` — регламенты
- `frontend/app/src/styles/results.css` — результаты
- `frontend/app/src/styles/about-championship.css` — о чемпионате
- `frontend/app/src/styles/public-gallery.css` — галерея
- `frontend/app/src/styles/components.css` — компоненты
- `frontend/app/src/styles/footer.css` — футер
- `frontend/app/src/styles/toast.css` — уведомления
- `frontend/app/src/styles/info-modal.css` — модальные окна
- `frontend/app/src/styles/confirm-dialog.css` — диалоги
- `frontend/app/src/styles/sponsors-section.css` — спонсоры
- `frontend/app/src/styles/tasks-section.css` — задачи
- `frontend/app/src/styles/pages-common.css` — общие стили

---

## Мустаев Венер Фанисович
### Административная часть (панель администратора)

### Backend

#### 1. Управление участниками
**Файлы:**
- `backend/controllers/participants-controller.js` — контроллер участников
- `backend/service/user-service.js` (административные методы)

**API эндпоинты:**
- `GET /api/admin/participants` — список участников
- `GET /api/admin/participants/stats` — статистика
- `GET /api/admin/participants/export` — экспорт в Excel
- `GET /api/admin/participants/:id` — информация об участнике
- `PUT /api/admin/participants/:id/place` — установка места
- `DELETE /api/admin/participants/:id` — удаление
- `POST /api/admin/participants/send-essay-reminders` — напоминания об эссе
- `POST /api/admin/participants/send-team-format-without-team-reminders` — напоминания о команде
- `GET /api/admin/teams` — список команд

**Функционал:**
- Просмотр всех участников
- Фильтрация по классам, формату, команде
- Поиск по ФИО, email, школе
- Экспорт в Excel
- Установка мест
- Удаление участников
- Массовая рассылка напоминаний

#### 2. Управление аудиториями
**Файлы:**
- `backend/controllers/room-controller.js` — контроллер аудиторий
- `backend/service/room-service.js` — сервис аудиторий
- `backend/models/room-model.js` — модель аудитории
- `backend/validation/room-validation.js` — валидация

**API эндпоинты:**
- `POST /api/admin/rooms` — создание
- `GET /api/admin/rooms` — список
- `GET /api/admin/rooms/:id` — информация
- `PUT /api/admin/rooms/:id` — обновление
- `DELETE /api/admin/rooms/:id` — удаление

**Функционал:**
- CRUD операции с аудиториями
- Управление вместимостью
- Валидация данных

#### 3. Управление рассадкой
**Файлы:**
- `backend/controllers/seating-controller.js` — контроллер рассадки
- `backend/service/seating-service.js` — сервис рассадки
- `backend/models/seating-assignment-model.js` — модель рассадки

**API эндпоинты:**
- `POST /api/admin/seating/auto-assign` — автоматическая рассадка
- `GET /api/admin/seating` — текущая рассадка
- `GET /api/admin/seating/export` — экспорт в Excel
- `GET /api/admin/seating/unassigned` — нераспределенные
- `POST /api/admin/seating/add-unassigned` — добавить нераспределенных
- `DELETE /api/admin/seating/clear` — очистка
- `POST /api/admin/seating/assign` — ручное назначение
- `POST /api/admin/seating/remove` — удаление назначения

**Функционал:**
- Алгоритм автоматической рассадки
- Распределение по классам и аудиториям
- Учет вместимости
- Ручное управление
- Экспорт рассадки

#### 4. Генерация сертификатов
**Файлы:**
- `backend/controllers/certificate-controller.js` — контроллер сертификатов
- `backend/service/certificate-service.js` — сервис сертификатов

**API эндпоинты:**
- `POST /api/admin/certificates/upload-template` — загрузка шаблона
- `POST /api/admin/certificates/upload-font` — загрузка шрифта
- `GET /api/admin/certificates/settings` — настройки
- `PUT /api/admin/certificates/settings` — обновление настроек
- `GET /api/admin/certificates/template` — получение шаблона
- `GET /api/admin/certificates/preview` — предпросмотр
- `GET /api/admin/certificates/preview/:participantId` — предпросмотр участника
- `GET /api/admin/certificates/generate/:participantId` — генерация одного
- `POST /api/admin/certificates/generate-all` — массовая генерация
- `POST /api/admin/certificates/issue` — выдача сертификатов
- `POST /api/admin/certificates/send-notifications` — отправка уведомлений
- `GET /api/admin/certificates/participants` — список для выдачи

**Функционал:**
- Работа с PDF-lib
- Загрузка шаблонов и шрифтов
- Настройка позиции текста
- Настройка размера и цвета шрифта
- Генерация PDF сертификатов
- Массовая выдача
- Email уведомления

#### 5. Файловый менеджер
**Файлы:**
- `backend/controllers/file-controller.js` — контроллер файлов
- `backend/service/file-service.js` — сервис файлов
- `backend/models/file-model.js` — модель файла

**API эндпоинты:**
- `POST /api/admin/files/upload` — загрузка
- `GET /api/admin/files` — список
- `GET /api/admin/files/stats` — статистика
- `GET /api/admin/files/:id` — информация
- `PUT /api/admin/files/:id` — обновление
- `DELETE /api/admin/files/:id` — удаление

**Функционал:**
- Загрузка файлов (Multer)
- Категоризация (регламенты, галерея, спонсоры)
- Управление метаданными
- Статистика по файлам
- Удаление файлов

#### 6. Управление настройками
**Файлы:**
- `backend/controllers/settings-controller.js` — контроллер настроек
- `backend/service/settings-service.js` — сервис настроек
- `backend/models/settings-model.js` — модель настроек

**API эндпоинты:**
- `GET /api/admin/settings` — получение настроек
- `PUT /api/admin/settings` — обновление
- `POST /api/admin/settings/clear-data` — очистка данных

**Функционал:**
- Открытие/закрытие регистрации
- Установка дат регистрации
- Установка даты чемпионата
- Дедлайн для эссе
- Очистка данных для нового года

#### 7. Управление результатами
**Файлы:**
- `backend/controllers/results-controller.js` — контроллер результатов
- `backend/service/results-service.js` — сервис результатов
- `backend/models/championship-result-model.js` — модель результатов

**API эндпоинты:**
- `GET /api/admin/results` — все результаты
- `POST /api/admin/results` — создание вручную
- `POST /api/admin/results/from-participants` — создание из участников
- `POST /api/admin/results/send-winner-notifications` — уведомления победителям
- `PUT /api/admin/results/:id` — обновление
- `DELETE /api/admin/results/:id` — удаление

**Функционал:**
- Создание результатов
- Автоматическое копирование из участников
- Фильтрация по годам
- Уведомления победителям (1-3 места)

#### 8. Резервное копирование
**Файлы:**
- `backend/controllers/backup-controller.js` — контроллер бэкапов
- `backend/service/backup-service.js` — сервис бэкапов
- `backend/backup.sh` — скрипт резервного копирования

**API эндпоинты:**
- `POST /api/admin/backups` — создание
- `GET /api/admin/backups` — список
- `GET /api/admin/backups/download/:filename` — скачивание
- `DELETE /api/admin/backups/:filename` — удаление

**Функционал:**
- Создание дампов PostgreSQL
- Управление резервными копиями
- Автоматическое резервное копирование

#### 9. Middleware и обработка ошибок
**Файлы:**
- `backend/middlewares/admin-middleware.js` — проверка роли администратора
- `backend/middlewares/validation-middleware.js` — обработка валидации
- `backend/middlewares/error-middleware.js` — обработка ошибок
- `backend/exceptions/api-error.js` — классы ошибок

**Функционал:**
- Ограничение доступа к админ-панели
- Централизованная обработка ошибок
- Форматирование ответов

---

### Frontend

#### 1. Структура админ-панели
**Файлы:**
- `frontend/app/src/pages/admin/AdminLayout.js` — макет
- `frontend/app/src/pages/admin/AdminSidebar.js` — боковое меню
- `frontend/app/src/pages/admin/AdminDashboard.js` — главная панель

**Функционал:**
- Защита маршрутов
- Навигация по разделам
- Статистика на главной

#### 2. Управление участниками
**Файлы:**
- `frontend/app/src/pages/admin/Participants.js` — страница участников
- `frontend/app/src/services/ParticipantsService.js` — сервис

**Функционал:**
- Таблица участников
- Фильтры и поиск
- Просмотр деталей
- Редактирование мест
- Удаление
- Экспорт в Excel
- Массовая рассылка

#### 3. Управление аудиториями
**Файлы:**
- `frontend/app/src/pages/admin/Rooms.js` — страница аудиторий
- `frontend/app/src/services/RoomService.js` — сервис

**Функционал:**
- Список аудиторий
- Создание/редактирование
- Удаление
- Отображение вместимости

#### 4. Управление рассадкой
**Файлы:**
- `frontend/app/src/pages/admin/Seating.js` — страница рассадки
- `frontend/app/src/services/SeatingService.js` — сервис

**Функционал:**
- Визуализация рассадки
- Автоматическая рассадка
- Ручное перемещение
- Экспорт в Excel
- Очистка

#### 5. Генерация сертификатов
**Файлы:**
- `frontend/app/src/pages/admin/Certificates.js` — страница сертификатов
- `frontend/app/src/components/CertificatePreview.js` — предпросмотр
- `frontend/app/src/services/CertificateService.js` — сервис

**Функционал:**
- Загрузка шаблона и шрифта
- Интерактивная настройка позиции текста
- Настройка размера и цвета
- Предпросмотр в реальном времени
- Выбор участников
- Массовая выдача
- Отправка уведомлений

#### 6. Файловый менеджер
**Файлы:**
- `frontend/app/src/pages/admin/FileManager.js` — страница файлов
- `frontend/app/src/services/FileService.js` — сервис
- `frontend/app/src/styles/file-manager.css` — стили

**Функционал:**
- Загрузка файлов (drag-and-drop)
- Список файлов
- Фильтрация по типу
- Предпросмотр
- Редактирование метаданных
- Удаление
- Статистика

#### 7. Управление настройками
**Файлы:**
- `frontend/app/src/pages/admin/Settings.js` — страница настроек
- `frontend/app/src/services/SettingsService.js` — сервис

**Функционал:**
- Управление регистрацией
- Установка дат
- Дедлайн эссе
- Очистка данных
- Подтверждение операций

#### 8. Управление результатами
**Файлы:**
- `frontend/app/src/pages/admin/ResultsManagement.js` — страница результатов
- `frontend/app/src/services/ResultsService.js` — сервис

**Функционал:**
- Список результатов
- Фильтрация по годам
- Создание вручную
- Автоматическое создание
- Редактирование
- Удаление
- Уведомления победителям

#### 9. CMS
**Файлы:**
- `frontend/app/src/pages/admin/CMS.js` — страница CMS

**Функционал:**
- Управление контентом сайта
- Редактирование разделов

#### 10. Сервисы и стили
**Файлы:**
- `frontend/app/src/services/BackupService.js` — резервные копии
- `frontend/app/src/styles/admin.css` — стили админ-панели
- `frontend/app/src/styles/admin-modern.css` — современный дизайн

---

## Общая инфраструктура (совместная работа)

### 1. База данных
**Файлы:**
- `backend/db.js` — конфигурация Sequelize
- Все модели в `backend/models/`

**Функционал:**
- Подключение к PostgreSQL
- Синхронизация моделей
- Связи между таблицами

### 2. Маршрутизация
**Файлы:**
- `backend/router/index.js` — главный роутер

**Функционал:**
- Все маршруты API
- Подключение middleware
- Разделение публичных и защищенных маршрутов

### 3. Docker и развертывание
**Файлы:**
- `docker-compose.yml` — конфигурация сервисов
- `backend/Dockerfile` — образ backend
- `frontend/app/Dockerfile` — образ frontend
- `nginx.conf` — конфигурация Nginx

**Функционал:**
- Контейнеризация приложения
- Настройка volumes
- Reverse proxy

### 4. Документация
**Файлы:**
- `README.md` — полная документация проекта

### 5. Вспомогательные скрипты
**Файлы:**
- `backend/scripts/seed-test-data.js` — тестовые данные

---

## Итоговая статистика

### Якшибаев Данир Ильдарович — Пользовательская часть

**Backend:**
- 4 контроллера (user, password-reset, school, team)
- 4 сервиса (user, token, school, team, mail)
- 3 модели (user, token, school, team)
- 3 файла валидации
- 1 middleware (auth)
- 1 скрипт (import-schools)
- ~20 API эндпоинтов

**Frontend:**
- 13 страниц (регистрация, вход, профиль, публичные страницы)
- 10 компонентов
- 4 сервиса
- 1 store (MobX)
- 1 HTTP клиент
- ~22 CSS файла

**Основной функционал:**
- Полная система аутентификации
- Личный кабинет участника
- Система команд
- Работа со школами
- Все публичные страницы
- Email-уведомления
- Скачивание сертификатов

---

### Мустаев Венер Фанисович — Административная часть

**Backend:**
- 8 контроллеров (participants, room, seating, certificate, file, settings, results, backup)
- 8 сервисов (room, seating, certificate, file, settings, results, backup)
- 4 модели (room, seating-assignment, file, championship-result, settings)
- 1 файл валидации (room)
- 2 middleware (admin, validation, error)
- 1 класс ошибок
- 1 скрипт (backup.sh)
- ~45 API эндпоинтов

**Frontend:**
- 9 административных страниц
- 1 компонент (CertificatePreview)
- 6 сервисов
- 2 CSS файла для админ-панели

**Основной функционал:**
- Полная административная панель
- Управление участниками
- Управление аудиториями и рассадкой
- Генерация сертификатов (PDF-lib)
- Файловый менеджер
- Управление настройками
- Управление результатами
- Резервное копирование
- Система безопасности (middleware)

---

## Заключение

Проект представляет собой полнофункциональное веб-приложение для организации чемпионата по программированию. Работа четко разделена:

**Якшибаев Д.И.** — вся пользовательская часть: регистрация, авторизация, личный кабинет, команды, публичные страницы.

**Мустаев В.Ф.** — вся административная часть: управление участниками, аудиториями, рассадкой, генерация сертификатов, файловый менеджер, настройки, результаты, резервное копирование.

Проект реализован с использованием современных технологий и обеспечивает удобный интерфейс как для участников, так и для администраторов чемпионата.
